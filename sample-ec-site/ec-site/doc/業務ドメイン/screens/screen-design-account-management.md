# アカウント管理画面 設計書

## 1. 概要

- **画面名**: アカウント管理画面
- **URL**: `/admin/accounts`
- **ファイルパス**: `presentation/src/main/resources/templates/admin/accounts.html` (想定)
- **アクセス制御**: 管理者ロールを持つユーザーのみアクセス可能。
- **概要**: ユーザーアカウントの検索、状態確認、ロック解除、パスワード初期化を行うための画面。

## 2. 画面レイアウト

```
+----------------------------------------------------------------------------------+
|                                                                                  |
|                         ECサイト - アカウント管理                                |
|                                                                                  |
+----------------------------------------------------------------------------------+
|                                                                                  |
| [検索条件]                                                                       |
| ユーザーID: [_______________]  ユーザー名: [_________________] [検索]              |
|                                                                                  |
| --- 検索結果 -------------------------------------------------------------------- |
|                                                                                  |
| | ユーザーID | ユーザー名 | 状態     | アクション                               | |
| |------------|------------|----------|------------------------------------------| |
| | user01     | 山田 太郎  | 有効     | [パスワード初期化]                       | |
| | user02     | 鈴木 一郎  | ロック中 | [ロック解除] [パスワード初期化]          | |
| | user03     | 佐藤 花子  | 無効     | [パスワード初期化]                       | |
| | ...        | ...        | ...      | ...                                      | |
|                                                                                  |
|                                                     ページネーション [1, 2, 3] |
+----------------------------------------------------------------------------------+
```

## 3. 画面項目一覧

### 3.1. 検索条件

| No. | 項目名     | 項目ID (`name`属性) | 型         | 説明                 |
|:----|:-----------|:--------------------|:-----------|:---------------------|
| 1   | ユーザーID | `userId`            | テキストボックス | 検索対象のユーザーID（部分一致） |
| 2   | ユーザー名 | `name`              | テキストボックス | 検索対象のユーザー名（部分一致） |

### 3.2. 検索結果

| No. | カラム名   | 説明                                                                     |
|:----|:-----------|:-------------------------------------------------------------------------|
| 1   | ユーザーID | アカウントのユーザーID                                                   |
| 2   | ユーザー名 | ユーザーの氏名                                                           |
| 3   | 状態       | アカウントの状態を表示（例: "有効", "ロック中", "無効"）                 |
| 4   | アクション | 各アカウントに対して実行可能な操作のボタンを表示（後述）                 |

## 4. アクション

| No. | アクション名       | 概要                                                                       | 備考                                                                                               |
|:----|:-------------------|:---------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------|
| 1   | 検索               | 入力された条件でユーザーアカウントを検索し、結果一覧を更新する             |                                                                                                    |
| 2   | ロック解除         | 「ロック中」状態のアカウントを「有効」にする                               | ・ボタンはアカウントが「ロック中」の場合のみ表示<br>・実行前に確認ダイアログを表示（例: 「ロックを解除しますか？」） |
| 3   | パスワード初期化   | 対象アカウントのパスワードを初期パスワード (`password123`) にリセットする。<br>同時にアカウントロックも解除される。 | ・実行前に確認ダイアログを表示（例: 「パスワードを初期化しますか？」）<br>・成功後、画面にメッセージを表示（例:「パスワードを初期化しました」） |

## 5. 表示ロジック

- **状態の表示**:
    - `AUTH_ACCOUNT.enabled` と `AUTH_ACCOUNT_LOCK_HISTORY` テーブルの最新状態を組み合わせて表示を決定する。
    - `enabled = false` -> "無効"
    - `enabled = true` かつ ロック中 -> "ロック中"
    - `enabled = true` かつ 非ロック中 -> "有効"
- **アクションボタンの表示制御**:
    - 「ロック解除」ボタンは、状態が「ロック中」のアカウントの行にのみ表示する。
