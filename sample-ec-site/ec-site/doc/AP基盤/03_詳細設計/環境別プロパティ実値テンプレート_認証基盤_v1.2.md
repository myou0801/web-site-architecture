# 環境別プロパティ実値テンプレート（認証基盤）

本ファイルは、認証基盤のプロパティについて **環境別の実値** を確定し、業務チーム/運用/基盤の合意を取るためのテンプレートである。

## 1. 適用環境
- Dev（開発）
- IT/ST（結合・総合試験）
- Prod（本番）

## 2. プロパティ実値一覧

| Key | Dev | IT/ST | Prod | 備考 |
|---|---|---|---|---|
| auth.post-login-success-url | TBD | TBD | TBD | 業務メニューURL。環境別に設定 |
| auth.session.max-sessions | 1 | 1 | 1 | U-07 推奨方針（必要なら変更） |
| auth.session.absolute-timeout-hours | 12 | TBD | TBD | D-08。UXと合わせて確定 |
| auth.web.forwarded-header.enabled | false | true | true | LB配下はtrue |
| auth.web.correlation-id.header | X-Correlation-Id | X-Correlation-Id | X-Correlation-Id | D-06 |
| auth.web.correlation-id.generate-if-absent | true | true | true |  |
| auth.audit.login-success.enabled | false | false | false/TBD | 監査要件がある場合のみtrue |
| auth.password.history-count | 3 | 3 | 3 |  |
| auth.password.min-length | 12 | 12 | 12 |  |
| auth.password.max-length | 64 | 64 | 64 |  |
| auth.password.require-alpha | true | true | true |  |
| auth.password.require-digit | true | true | true |  |
| auth.password.prohibit-include-login-id | true | true | true |  |
| auth.password.prohibit-seq-length | 3 | 3 | 3 |  |
| auth.password.prohibit-repeat-length | 4 | 4 | 4 |  |
| auth.initial-password-hash | TBD | TBD | TBD | bcrypt hash（平文保持禁止） |
| auth.audit.loginId.hmac-secret | TBD | TBD | TBD | Secretsで管理（平文を設定ファイルに置かない） |

## 3. Secrets管理（補足）

- auth.audit.loginId.hmac-secret
  - 管理: Secrets Manager / K8s Secret / Vault 等
  - ローテ: **必要時のみ**（キー変更日で期間分割運用）
- auth.initial-password-hash
  - 平文初期PWは保持しない
  - 変更時は運用手順に従い bcrypt hash を更新する

## 4. 確定記録（決定ログ）

| 項目 | 決定 | 日付 | 決定者 | 備考 |
|---|---|---|---|---|
| operatedBy | loginId | 2026-01-25 | TBD | 監査ログ上の操作者識別子 |
| LOGIN_SUCCESS監査 | default OFF | 2026-01-25 | TBD | `auth.audit.login-success.enabled=false` |
| 絶対タイムアウトUX | loginへリダイレクト | 2026-01-25 | TBD | `/login?reason=timeout` |
| HMACキー運用 | 必要時のみローテ | 2026-01-25 | TBD | キー変更日で期間分割 |
| H2互換VIEW | DDL分離管理 | 2026-01-25 | TBD | UT側DDLで吸収 |
